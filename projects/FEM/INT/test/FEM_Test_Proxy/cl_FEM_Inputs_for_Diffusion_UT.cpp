/*
 * Copyright (c) 2022 University of Colorado
 * Licensed under the MIT license. See LICENSE.txt file in the MORIS root for details.
 *
 *------------------------------------------------------------------------------------
 *
 * cl_FEM_Inputs_for_Diffusion_UT.cpp
 *
 */

#include "cl_Matrix.hpp"
#include "linalg_typedefs.hpp"
#include "fn_trans.hpp"

#include "cl_FEM_Field_Interpolator_Manager.hpp"

using namespace moris;

inline void
tConstValFunc_Diff(
        moris::Matrix< moris::DDRMat >&                aPropMatrix,
        Vector< moris::Matrix< moris::DDRMat > >& aParameters,
        moris::fem::Field_Interpolator_Manager*        aFIManager )
{
    aPropMatrix = aParameters( 0 );
}

inline void
tTEMPFIValFunc_Diff(
        moris::Matrix< moris::DDRMat >&                aPropMatrix,
        Vector< moris::Matrix< moris::DDRMat > >& aParameters,
        moris::fem::Field_Interpolator_Manager*        aFIManager )
{
    aPropMatrix = aParameters( 0 ) * aFIManager->get_field_interpolators_for_type( moris::MSI::Dof_Type::TEMP )->val();
}

inline void
tTEMPFIDerFunc_Diff(
        moris::Matrix< moris::DDRMat >&                aPropMatrix,
        Vector< moris::Matrix< moris::DDRMat > >& aParameters,
        moris::fem::Field_Interpolator_Manager*        aFIManager )
{
    aPropMatrix = aParameters( 0 ) * aFIManager->get_field_interpolators_for_type( moris::MSI::Dof_Type::TEMP )->N();
}

inline void
fill_that(
        moris::Matrix< moris::DDRMat >& tTHat,
        moris::uint                     aSpaceDim,
        moris::uint                     aInterpOrder )
{
    switch ( aSpaceDim )
    {
        case 2:
        {
            switch ( aInterpOrder )
            {
                case 1:
                    tTHat = { { +2.392766208083287e+01,
                            +3.200648916622891e+01,
                            +9.105008519852706e+01,
                            +1.648329829858856e+01,
                            +2.455327506604995e+01,
                            +1.983196862781825e+01,
                            +7.158927215290831e+01,
                            +9.678247287159471e+01 } };
                    break;
                case 2:
                    tTHat = { { +6.113033620136942e+01,
                            +5.731190556302565e+01,
                            +7.737546164794847e+01,
                            +1.796579506535230e+01,
                            +1.352846459763928e+01,
                            +6.402068200838963e+01,
                            +4.208421679434274e+01,
                            +7.131745513234338e+01,
                            +9.050525998679390e+01,
                            +6.489292240369569e+01,
                            +4.032323821336649e+01,
                            +2.389180106638707e+01,
                            +4.320292602460271e+01,
                            +7.516097176419426e+01,
                            +3.776395757074206e+01,
                            +5.840220908877829e+01,
                            +4.344529780636583e+01,
                            +2.321488639358367e+01 } };
                    break;
                case 3:
                    tTHat = { { +5.807241361757317e+01,
                            +6.396931150151166e+01,
                            +4.922624553701569e+01,
                            +3.019826798687895e+01,
                            +5.504882274916299e+01,
                            +9.890453113201571e+01,
                            +7.840378345498097e+01,
                            +2.374965952246307e+01,
                            +2.998243116508974e+01,
                            +8.004437736458465e+01,
                            +2.993467897447444e+01,
                            +5.963767095198010e+01,
                            +4.886557465927394e+01,
                            +9.767283326074985e+01,
                            +5.817059095754988e+01,
                            +2.080915998889685e+01,
                            +4.777638379129450e+01,
                            +6.249081659787228e+01,
                            +8.950769554540395e+01,
                            +3.540010104467171e+01,
                            +3.752690195562932e+01,
                            +7.680513964873023e+01,
                            +2.871219267576506e+01,
                            +2.143227761001664e+01,
                            +5.729905605380479e+01,
                            +1.419406708794352e+01,
                            +6.574376388047958e+01,
                            +7.528878778343048e+01,
                            +7.341617675930220e+01,
                            +5.953472534664772e+01,
                            +4.725400054046189e+01,
                            +7.670202352336537e+01 } };
                    break;
                default:
                    MORIS_ERROR( false, "can only be 1, 2, 3" );
                    break;
            }
            break;
        }
        case 3:
        {
            switch ( aInterpOrder )
            {
                case 1:
                    tTHat = { { +2.390147774129654e+01,
                            +5.659911796378445e+01,
                            +6.184863726186082e+01,
                            +3.263254682362039e+01,
                            +1.845748801737600e+01,
                            +2.812599184626938e+01,
                            +6.329633098553595e+01,
                            +5.552645675727477e+01,
                            +6.115121464610250e+01,
                            +1.706048697221760e+01,
                            +7.517338902481112e+01,
                            +1.807416055897830e+01,
                            +4.171497570599884e+01,
                            +1.610448449109448e+01,
                            +9.478239312249293e+01,
                            +3.336125423168365e+01 } };
                    break;
                case 2:
                    tTHat = { { +2.580400845919633e+01,
                            +3.367208380757102e+01,
                            +7.180100571244287e+01,
                            +3.357844968910215e+01,
                            +5.147515776819019e+01,
                            +1.643820812554400e+01,
                            +5.904631691246289e+01,
                            +3.325429084925931e+01,
                            +9.143101516441290e+01,
                            +1.748848261664332e+01,
                            +6.621973619327474e+01,
                            +8.388476438964169e+01,
                            +7.099166100328172e+01,
                            +3.384081017343997e+01,
                            +6.583647904979500e+01,
                            +9.304667754622551e+01,
                            +5.333462859887226e+01,
                            +7.160162032753232e+01,
                            +8.385651532950844e+01,
                            +6.403298895401124e+01,
                            +7.478228930477123e+01,
                            +3.358189018771750e+01,
                            +3.398754390538400e+01,
                            +8.159462878531248e+01,
                            +5.747966238542291e+01,
                            +5.052452244647541e+01,
                            +8.528273158613364e+01,
                            +6.054753517651785e+01,
                            +4.989970695596042e+01,
                            +3.839969918369300e+01,
                            +6.613945613540471e+01,
                            +3.887620499007026e+01,
                            +9.129447808961977e+01,
                            +6.132250436274312e+01,
                            +3.518051217009427e+01,
                            +2.679181209346603e+01,
                            +9.134757636305235e+01,
                            +5.408606837628231e+01,
                            +5.923924798793679e+01,
                            +3.904103744654338e+01,
                            +6.347317725044059e+01,
                            +3.217859717150998e+01,
                            +7.146042054303592e+01,
                            +7.162403006479563e+01,
                            +5.021291285620407e+01,
                            +5.812718123153936e+01,
                            +6.212183722557491e+01,
                            +4.199412937556632e+01,
                            +3.544867703498005e+01,
                            +1.381328186276715e+01,
                            +2.562197326897250e+01,
                            +7.604640365364759e+01,
                            +4.408784900316332e+01,
                            +7.221025769338628e+01 } };
                    break;

                case 3:
                    tTHat = { { +3.544762481617121e+01,
                            +9.916334726859210e+01,
                            +1.350554928855513e+01,
                            +2.280046810151149e+01,
                            +7.619447479490530e+01,
                            +5.288451509499921e+01,
                            +1.448308877146643e+01,
                            +3.761219748756130e+01,
                            +7.916630689762025e+01,
                            +3.260250249485488e+01,
                            +9.505405257937034e+01,
                            +3.245916727570843e+01,
                            +2.936015972718700e+01,
                            +9.475173109376192e+01,
                            +1.188436400898940e+01,
                            +9.437408085161705e+01,
                            +2.573316932960386e+01,
                            +2.234885197537894e+01,
                            +9.814531851535328e+01,
                            +7.558132516504462e+01,
                            +8.790282779907544e+01,
                            +8.793328211946557e+01,
                            +2.031942172071885e+01,
                            +9.370497435927180e+01,
                            +4.437453618232512e+01,
                            +1.473211484511923e+01,
                            +4.063667312801019e+01,
                            +2.516265757004938e+01,
                            +4.460261350903891e+01,
                            +6.189863958793159e+01,
                            +4.774519068618597e+01,
                            +5.614635581657670e+01,
                            +6.873695913210742e+01,
                            +5.749506024948334e+01,
                            +2.512947609377866e+01,
                            +6.786738668743230e+01,
                            +5.559572600280350e+01,
                            +4.426674518313845e+01,
                            +4.297613000413514e+01,
                            +3.091891055158349e+01,
                            +3.501072063449395e+01,
                            +9.103227410328934e+01,
                            +8.144588801251035e+01,
                            +8.052793222814483e+01,
                            +3.083376987364469e+01,
                            +3.785425499940742e+01,
                            +6.531292036058626e+01,
                            +1.453033273665981e+01,
                            +7.026909830983203e+01,
                            +1.678712355453204e+01,
                            +7.027996920617815e+01,
                            +8.937410416900698e+01,
                            +4.128075211077559e+01,
                            +3.214811709355029e+01,
                            +2.386557616551182e+01,
                            +1.836779788643337e+01,
                            +3.850367252743013e+01,
                            +4.735695634292234e+01,
                            +2.904347716857930e+01,
                            +6.548718392853658e+01,
                            +3.347061120057187e+01,
                            +3.587244738273156e+01,
                            +3.498104222476851e+01,
                            +1.078246012572490e+01,
                            +1.055705270728102e+01,
                            +8.207870460669609e+01,
                            +8.879683565408055e+01,
                            +3.438440962223454e+01,
                            +5.170334370500129e+01,
                            +9.878892051977515e+01,
                            +6.278395626665820e+01,
                            +4.821392265714860e+01,
                            +1.862455047642848e+01,
                            +5.497136308556061e+01,
                            +9.091498514644209e+01,
                            +2.188306364803395e+01,
                            +6.519625965283325e+01,
                            +3.463604467457873e+01,
                            +7.394053196575634e+01,
                            +4.115460053882457e+01,
                            +8.399655641925612e+01,
                            +6.610702658380630e+01,
                            +3.973582888049505e+01,
                            +9.332317012237336e+01,
                            +3.773683375268477e+01,
                            +9.688954997979810e+01,
                            +1.067610685296563e+01,
                            +4.395029828441865e+01,
                            +8.900855955699039e+01,
                            +1.298184470865693e+01,
                            +8.102291550336886e+01,
                            +3.120218473658895e+01,
                            +2.655017954357146e+01,
                            +1.453871777684398e+01,
                            +9.057557314689366e+01,
                            +6.353336802763300e+01,
                            +2.751682900954426e+01,
                            +6.110980735822725e+01,
                            +1.200593903203251e+01,
                            +8.765063094482227e+01,
                            +9.853498914464632e+01,
                            +2.670745349094347e+01,
                            +2.010505022910209e+01,
                            +6.165695275495051e+01,
                            +5.569174933098506e+01,
                            +9.664954258097075e+01,
                            +6.261041228420322e+01,
                            +8.425854026363130e+01,
                            +4.306631624787271e+01,
                            +7.258990742164315e+01,
                            +4.966366924604244e+01,
                            +1.895751473660814e+01,
                            +9.601434656990293e+01,
                            +2.954055990402827e+01,
                            +9.864572324833357e+01,
                            +9.784003017283960e+01,
                            +8.427030980523990e+01,
                            +8.240788680609842e+01,
                            +5.180091112057990e+01,
                            +9.389617130333802e+01,
                            +8.213110169947200e+01,
                            +1.817034579962336e+01,
                            +4.736962038773205e+01,
                            +7.369245510018419e+01,
                            +7.551995332914466e+01,
                            +8.147945636979877e+01,
                            +7.614042434371412e+01,
                            +6.564338328517056e+01 } };
                    break;
                default:
                    MORIS_ERROR( false, "can only be 1, 2, 3" );
                    break;
            }
            break;
        }
        default:
            MORIS_ERROR( false, "can only be 2 or 3D" );
            break;
    }
    tTHat = trans( tTHat );
}
